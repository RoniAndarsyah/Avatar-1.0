"use strict";var PPressPagesMailOptin=window.PPressPagesMailOptin||function(t,s,n){var e={},a={init:function(){n(t).ready(a.ready)},ready:function(){a.initVars(),a.events()},initVars:function(){e={$stepInstall:n("section.step-install"),$stepInstallNum:n("section.step-install .num img"),$stepSetup:n("section.step-setup"),$stepSetupNum:n("section.step-setup .num img")}},events:function(){e.$stepInstall.on("click","button",a.stepInstallClick),e.$stepSetup.on("click","button",a.gotoURL)},stepInstallClick:function(){var t=n(this),l=t.attr("data-action"),i=t.attr("data-plugin"),p="";if(!t.hasClass("disabled")){switch(l){case"activate":p="ppress_activate_plugin",t.text(ppress_pluginlanding.activating);break;case"install":p="ppress_install_plugin",t.text(ppress_pluginlanding.installing);break;case"goto-url":return void(s.location.href=t.attr("data-url"));default:return}t.addClass("disabled"),a.showSpinner(e.$stepInstallNum);var r={action:p,nonce:ppress_admin_globals.nonce,plugin:i,type:"plugin"};n.post(ajaxurl,r).done((function(s){a.stepInstallDone(s,t,l)})).always((function(){a.hideSpinner(e.$stepInstallNum)}))}},stepInstallDone:function(t,s,n){if(t.success)e.$stepInstallNum.attr("src",e.$stepInstallNum.attr("src").replace("step-1.","step-complete.")),s.addClass("grey").text(ppress_pluginlanding.activated),a.stepInstallPluginStatus();else{var l="install"===n?ppress_pluginlanding.manual_install_url:ppress_pluginlanding.manual_activate_url,i="install"===n?ppress_pluginlanding.error_could_not_install:ppress_pluginlanding.error_could_not_activate,p="install"===n?ppress_pluginlanding.download_now:ppress_pluginlanding.plugins_page;s.removeClass("grey disabled").text(p).attr("data-action","goto-url").attr("data-url",l),s.after('<p class="error">'+i+"</p>")}},stepInstallPluginStatus:function(){var t={action:"ppress_mailoptin_page_check_plugin_status",nonce:ppress_admin_globals.nonce};n.post(ajaxurl,t).done(a.stepInstallPluginStatusDone)},stepInstallPluginStatusDone:function(t){t.success&&(e.$stepSetup.removeClass("grey"),e.$stepSetupBtn=e.$stepSetup.find("button"),e.$stepSetupBtn.removeClass("grey disabled"),t.data.setup_status>0&&(e.$stepSetupNum.attr("src",e.$stepSetupNum.attr("src").replace("step-2.svg","step-complete.svg")),e.$stepSetupBtn.text(ppress_pluginlanding.smtp_settings_button)))},gotoURL:function(){var t=n(this);t.hasClass("disabled")||(s.location.href=t.attr("data-url"))},showSpinner:function(t){t.siblings(".loader").removeClass("hidden")},hideSpinner:function(t){t.siblings(".loader").addClass("hidden")}};return a}(document,window,jQuery);PPressPagesMailOptin.init();